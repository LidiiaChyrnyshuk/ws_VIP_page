<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Document</title>
		<style>
			body {
				padding: 0;
				margin: 0;
			}
			:root {
				--whiteColor: #ffffff;
				--blackColor: #000000;
				--lilaColor: #6352ff;
				--darkLilaColor: #584ed4;
				--greyLightColor: #f1f3f5;
				--greyColor: #4f606f;
				--greyDarkColor: #34414d;
			}
			@font-face {
				font-display: swap;
				font-family: Stolzl;
				font-style: normal;
				font-weight: 400;
				src:
					url(https://d36qhe25w9jqx.cloudfront.net/static/font/Stolzl-Regular.woff2)
						format("woff2"),
					url(https://d36qhe25w9jqx.cloudfront.net/static/font/Stolzl-Regular.woff)
						format("woff");
			}
			@font-face {
				font-display: swap;
				font-family: Stolzl;
				font-style: normal;
				font-weight: 500;
				src:
					url(https://d36qhe25w9jqx.cloudfront.net/static/font/Stolzl-Medium.woff2)
						format("woff2"),
					url(https://d36qhe25w9jqx.cloudfront.net/static/font/Stolzl-Medium.woff)
						format("woff");
			}

			.vip_page_level_slider {
				position: relative;
				padding-left: 8px;
				padding-right: 8px;
			}
			@media screen and (min-width: 960px) {
				.vip_page_level_slider {
					padding-left: 16px;
					padding-right: 16px;
				}
			}

			.vip_page_level_arrow_left {
				position: absolute;
				left: 16px;
				top: 50%;
				transform: translateY(-50%);
				z-index: 20;
			}

			.vip_page_level_arrow_right {
				position: absolute;
				top: 50%;
				right: 16px;
				transform: translateY(-50%);
				z-index: 20;
			}
			@media screen and (min-width: 960px) {
				.vip_page_level_arrow_left {
					left: 32px;
				}

				.vip_page_level_arrow_right {
					right: 32px;
				}
			}

			.vip_page_level_arrows_wrap a {
				display: -webkit-box;
				display: -ms-flexbox;
				display: flex;
				-webkit-box-align: center;
				-ms-flex-align: center;
				align-items: center;
				-webkit-box-pack: justify;
				-ms-flex-pack: justify;
				justify-content: center;
				border-radius: 12px;
				outline: none;
				width: 48px;
				height: 48px;
				background: #ffffff3d;
				backdrop-filter: blur(8px);
			}

			.vip_page_level_arrows_wrap a img {
				cursor: pointer;
			}
			#arrow-left-img {
				transform: rotate(180deg);
			}
			.vip_page_level_arrows_wrap a {
				transition: opacity 0.2s ease;
				opacity: 0.8;
				pointer-events: auto;
			}
			.vip_page_level_arrows_wrap a.is-disabled {
				opacity: 0;
				pointer-events: auto;
			}
			.vip_page_level_arrows_wrap a:not(.is-disabled):hover {
				opacity: 1;
			}
			/* Контейнер */
			.slider-container {
				position: relative;
				width: 100%;
				overflow: hidden;
				border-radius: 24px;
				border: 2px solid transparent;
				background-image:
					linear-gradient(#010808, #010808),
					linear-gradient(
						97.15deg,
						#f1c68a 0%,
						#ffeace 40%,
						#ffffff 50%,
						#ffeace 60%,
						#f1c68a 100%
					);
				background-origin: border-box;
				background-clip: padding-box, border-box;
				padding-top: 8px;
				padding-bottom: 8px;
			}

			.vip_page_level_container_mask {
				--mask-left: 10%;
				--mask-right: 90%;

				-webkit-mask-image: linear-gradient(
					to right,
					transparent 0%,
					#000 var(--mask-left),
					#000 var(--mask-right),
					transparent 100%
				);

				mask-image: linear-gradient(
					to right,
					transparent 0%,
					#000 var(--mask-left),
					#000 var(--mask-right),
					transparent 100%
				);

				mask-size: 100% 100%;
				mask-repeat: no-repeat;

				transition:
					mask-image 0.25s ease,
					-webkit-mask-image 0.25s ease;
			}

			@media screen and (min-width: 960px) {
				.slider-container {
					border-radius: 32px;
					padding-top: 16px;
					padding-bottom: 16px;
				}
			}
			/* Трек */
			.slider {
				display: -webkit-box;
				display: -ms-flexbox;
				display: flex;
				gap: 8px;

				will-change: transform;
				cursor: grab;
				touch-action: pan-y;
				height: 352px;
			}
			@media screen and (min-width: 960px) {
				.slider {
					height: 352px;
				}
			}

			/* Картка */

			.card {
				flex: 0 0 248px;
				height: 352px;
				background: #ffffff;
				border-radius: 16px;
				overflow: hidden;
				display: -webkit-box;
				display: -ms-flexbox;
				display: flex;
				-webkit-box-align: center;
				-ms-flex-align: center;
				align-items: center;
				-webkit-box-pack: justify;
				-ms-flex-pack: justify;
				justify-content: center;
				scroll-snap-align: none;
			}
			/* ховаємо скролл */
			.slider::-webkit-scrollbar {
				display: none;
			}
			#levels-slider {
				touch-action: pan-y;
			}
			/* свайп */
			#levels-slider {
				user-select: none;
				cursor: grab;
			}

			#levels-slider:active {
				cursor: grabbing;
			}
		</style>
	</head>
	<body>
		<section class="vip_page_level_slider">
			<div class="vip_page_level_arrows_wrap">
				<a href="#" id="arrow-left" class="vip_page_level_arrow_left"
					><img
						src="./images/buttons_icons.png"
						alt="arrow-left"
						id="arrow-left-img"
						width="24"
						height="24"
				/></a>
				<a href="#" id="arrow-right" class="vip_page_level_arrow_right"
					><img
						src="./images/buttons_icons.png"
						alt="arrow-right"
						id="arrow-right-img"
						width="24"
						height="24"
				/></a>
			</div>

			<div class="slider-container">
				<div class="vip_page_level_container_mask">
					<div class="slider" id="levels-slider">
						<div id="slide21" class="card">
							<img
								src="./images/level_21.png"
								alt="card"
								width="248"
								height="352"
							/>
						</div>
						<div id="slide22" class="card">
							<img
								src="./images/level_22.png"
								alt="card"
								width="248"
								height="352"
							/>
						</div>
						<div id="slide23" class="card">
							<img
								src="./images/level_23.png"
								alt="card"
								width="248"
								height="352"
							/>
						</div>
						<div id="slide24" class="card">
							<img
								src="./images/level_24.png"
								alt="card"
								width="248"
								height="352"
							/>
						</div>
						<div id="slide25" class="card">
							<img
								src="./images/level_25.png"
								alt="card"
								width="248"
								height="352"
							/>
						</div>
						<div id="slide26" class="card">
							<img
								src="./images/level_26.png"
								alt="card"
								width="248"
								height="352"
							/>
						</div>
						<div id="slide27" class="card">
							<img
								src="./images/level_27.png"
								alt="card"
								width="248"
								height="352"
							/>
						</div>
						<div id="slide28" class="card">
							<img
								src="./images/level_28.png"
								alt="card"
								width="248"
								height="352"
							/>
						</div>
						<div id="slide29" class="card">
							<img
								src="./images/level_29.png"
								alt="card"
								width="248"
								height="352"
							/>
						</div>
						<div id="slide30" class="card">
							<img
								src="./images/level_30.png"
								alt="card"
								width="248"
								height="352"
							/>
						</div>
					</div>
				</div>
			</div>
		</section>

		<script>
document.addEventListener("DOMContentLoaded", () => {

  const track = document.getElementById("levels-slider");
  const slides = Array.from(track.children);
  const btnLeft = document.getElementById("arrow-left");
  const btnRight = document.getElementById("arrow-right");
  const mask = document.querySelector(".vip_page_level_container_mask");

  const HOLD_DELAY = 300;
  const FAST_STEP = 3;
  const FAST_INTERVAL = 80;
  const DRAG_THRESHOLD = 8;

  let holdTimeout = null;
  let holdInterval = null;

  let position = 0;
  let cardWidth = 0;
  let maxShift = 0;

  let currentIndex = 0; 

  let velocity = 0;
  let startTime = 0;

  let dragging = false;
  let isDraggingNow = false;
  let startX = 0;
  let startPos = 0;

  /* ---------- HELPERS ---------- */

  const getGap = () =>
    parseFloat(getComputedStyle(track).gap) || 0;

  const getContainerWidth = () =>
    track.closest(".slider-container").clientWidth;

  const getCenterOffset = () =>
    getContainerWidth() / 2 - cardWidth / 2;

  const clampPosition = () => {
    if (position > 0) position = 0;
    if (position < maxShift) position = maxShift;
  };

  const getCurrentIndexFromPosition = () =>
    Math.round((-position + getCenterOffset()) / cardWidth);

  /* ---------- MASK + EDGE ---------- */

  const updateMaskAndEdgeOffset = () => {

    if (isDraggingNow) return 0;

    const atStart = currentIndex === 0;
    const atEnd = currentIndex === slides.length - 1;

    const edgeValue = window.innerWidth >= 960 ? 16 : 8;

    if (atStart) {
      mask.style.setProperty("--mask-left", "0%");
      mask.style.setProperty("--mask-right", "90%");
      return edgeValue;
    }

    if (atEnd) {
      mask.style.setProperty("--mask-left", "10%");
      mask.style.setProperty("--mask-right", "100%");
      return -edgeValue;
    }

    mask.style.setProperty("--mask-left", "10%");
    mask.style.setProperty("--mask-right", "90%");
    return 0;
  };

  const applyTransform = (animated = true) => {

    track.style.transition = animated
      ? "transform 0.45s cubic-bezier(0.22,0.61,0.36,1)"
      : "none";

    const edgeOffset = updateMaskAndEdgeOffset();

    track.style.transform =
      `translate3d(${position + edgeOffset}px,0,0)`;

    //  кнопки тепер залежать тільки від index
    btnLeft.classList.toggle("is-disabled", currentIndex === 0);
    btnRight.classList.toggle(
      "is-disabled",
      currentIndex === slides.length - 1
    );
  };

  /* ---------- NAVIGATION ---------- */

  const goToIndex = (index, animated = true) => {

    currentIndex = Math.max(
      0,
      Math.min(slides.length - 1, index)
    );

    position =
      -(currentIndex * cardWidth) + getCenterOffset();

    clampPosition();
    applyTransform(animated);
  };

  const recalc = () => {
    cardWidth = slides[0].offsetWidth + getGap();
    maxShift = -(track.scrollWidth - getContainerWidth());
    goToIndex(currentIndex, false);
  };

  window.addEventListener("resize", recalc);
  recalc();

  btnRight.addEventListener("click", e => {
    e.preventDefault();
    goToIndex(currentIndex + 1);
  });

  btnLeft.addEventListener("click", e => {
    e.preventDefault();
    goToIndex(currentIndex - 1);
  });

  /* ---------- DRAG ---------- */

  const dragStart = (e) => {
    dragging = true;
    isDraggingNow = true;

    startX = e.pageX || e.touches[0].pageX;
    startPos = position;
    startTime = Date.now();
    velocity = 0;

    track.style.transition = "none";
  };

  const dragMove = (e) => {
    if (!dragging) return;

    const x = e.touches ? e.touches[0].pageX : e.pageX;
    const delta = x - startX;

    if (Math.abs(delta) < DRAG_THRESHOLD) return;

    e.preventDefault();

    position = startPos + delta;

    const elapsed = Date.now() - startTime;
    if (elapsed > 0)
      velocity = Math.max(-3, Math.min(3, delta / elapsed));

    clampPosition();

    track.style.transform =
      `translate3d(${position}px,0,0)`;
  };

  const dragEnd = () => {
    if (!dragging) return;

    dragging = false;
    isDraggingNow = false;

    let index = getCurrentIndexFromPosition();

    if (Math.abs(velocity) > 0.5) {
      const boost = Math.min(4, Math.ceil(Math.abs(velocity) * 2));
      index += velocity < 0 ? boost : -boost;
    }

    goToIndex(index);
  };

  /* ---------- HOLD SCROLL ---------- */

  const startHold = (direction) => {
    holdTimeout = setTimeout(() => {
      holdInterval = setInterval(() => {
        goToIndex(currentIndex + (direction < 0 ? 1 : -1), false);
      }, FAST_INTERVAL);
    }, HOLD_DELAY);
  };

  const stopHold = () => {
    clearTimeout(holdTimeout);
    clearInterval(holdInterval);
    holdTimeout = null;
    holdInterval = null;
    goToIndex(currentIndex);
  };

  btnRight.addEventListener("mousedown", () => startHold(-1));
  btnLeft.addEventListener("mousedown", () => startHold(1));

  ["mouseup","mouseleave"].forEach(evt => {
    btnRight.addEventListener(evt, stopHold);
    btnLeft.addEventListener(evt, stopHold);
  });

  track.addEventListener("touchstart", dragStart, { passive: true });
  track.addEventListener("touchmove", dragMove, { passive: false });
  track.addEventListener("touchend", dragEnd);
  track.addEventListener("touchcancel", dragEnd);

  track.addEventListener("mousedown", e => {
    e.preventDefault();
    dragStart(e);
  });

  document.addEventListener("mousemove", dragMove);
  document.addEventListener("mouseup", dragEnd);

});
</script>

	</body>
</html>
